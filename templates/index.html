<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Jekyll v3.8.6">
    <title>Chismosito Bot</title>


    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

    <meta name="theme-color" content="#563d7c">


    <style>
        .bd-placeholder-img {
            font-size: 1.125rem;
            text-anchor: middle;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        @media (min-width: 768px) {
            .bd-placeholder-img-lg {
                font-size: 3.5rem;
            }
        }

        html,
        body {
            height: 100%;
        }

        body {
            display: -ms-flexbox;
            display: flex;
            -ms-flex-align: center;
            align-items: center;
            padding-top: 40px;
            padding-bottom: 40px;
            background-color: #f5f5f5;
        }

        .form-signin {
            width: 100%;
            max-width: 420px;
            padding: 15px;
            margin: auto;
        }

        .form-label-group {
            position: relative;
            margin-bottom: 1rem;
        }

        .form-label-group>input,
        .form-label-group>label {
            height: 3.125rem;
            padding: .75rem;
        }

        .form-label-group>label {
            position: absolute;
            top: 0;
            left: 0;
            display: block;
            width: 100%;
            margin-bottom: 0;
            /* Override default `<label>` margin */
            line-height: 1.5;
            color: #495057;
            pointer-events: none;
            cursor: text;
            /* Match the input under the label */
            border: 1px solid transparent;
            border-radius: .25rem;
            transition: all .1s ease-in-out;
        }

        .form-label-group input::-webkit-input-placeholder {
            color: transparent;
        }

        .form-label-group input:-ms-input-placeholder {
            color: transparent;
        }

        .form-label-group input::-ms-input-placeholder {
            color: transparent;
        }

        .form-label-group input::-moz-placeholder {
            color: transparent;
        }

        .form-label-group input::placeholder {
            color: transparent;
        }

        .form-label-group input:not(:placeholder-shown) {
            padding-top: 1.25rem;
            padding-bottom: .25rem;
        }

        .form-label-group input:not(:placeholder-shown)~label {
            padding-top: .25rem;
            padding-bottom: .25rem;
            font-size: 12px;
            color: #777;
        }

        /* Fallback for Edge
-------------------------------------------------- */
        @supports (-ms-ime-align: auto) {
            .form-label-group>label {
                display: none;
            }

            .form-label-group input::-ms-input-placeholder {
                color: #777;
            }
        }

        /* Fallback for IE
-------------------------------------------------- */
        @media all and (-ms-high-contrast: none),
        (-ms-high-contrast: active) {
            .form-label-group>label {
                display: none;
            }

            .form-label-group input:-ms-input-placeholder {
                color: #777;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        {% if members|length > 0 %}
        <form class="form-signin" id="send-form" action="/say" method="POST">
            <div class="text-center mb-4">
                <h1 class="h3 mb-3 font-weight-normal">Panel de voz de Chismosito Bot</h1>
            </div>

            <div class="form-label-group">
                <input type="text" id="text" class="form-control" name="text" placeholder="Texto" required autofocus>
                <label for="text">Texto</label>
            </div>
            <div class="form-label-group">
                <select class="form-control" id="select_name" name="select_name" style="border-radius: 0px;">
                    {% for member in members %}
                    <option value="{{ member }}">{{ member }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="voice" id="radio1" value="Jorge" checked>
                <label class="form-check-label" for="radio1">
                    Jorge
                </label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="voice" id="radio2" value="Marisol">
                <label class="form-check-label" for="radio2">
                    Marisol
                </label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="voice" id="radio3" value="Monica">
                <label class="form-check-label" for="radio3">
                    Monica
                </label>
            </div>
            <button id="send" class="btn btn-lg btn-primary btn-block" type="submit">Enviar</button>
            <p class="mt-5 mb-3 text-muted text-center">&copy; 2020</p>
        </form>
        {% else %}
        <div class="text-center mb-4">
            <h1 class="h3 mb-3 font-weight-normal">Panel de voz de Chismosito Bot</h1>
        </div>
        <div class="row">
            <div class="col-12">
                <h2 style="text-align: center;">No hay cojudos conectados</h2>
            </div>
        </div>
        {% endif %}
    </div>
</body>

<script src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

<script>

    function objectifyForm(formArray) {//serialize data function

        var returnArray = {};
        for (var i = 0; i < formArray.length; i++) {
            returnArray[formArray[i]['name']] = formArray[i]['value'];
        }
        return returnArray;
    }

    $(document).ready(function () {
        $(function () {
            var frm = $('#send-form');
            frm.submit(function (ev) {
                ev.preventDefault();
                obj = objectifyForm(frm.serializeArray())
                if (obj.text.length > 250) {
                    alert("Texto muy grande")
                    return;
                }
                $.ajax({
                    type: frm.attr('method'),
                    url: frm.attr('action'),
                    data: JSON.stringify(obj),
                    contentType: "application/json",
                    success: function (data, textStatus, xhr) {
                        $("input#text").val("")
                        $("input#member_name").val("")
                        alert(data.message)
                    }
                });
            });
        });
    })

</script>

</html>